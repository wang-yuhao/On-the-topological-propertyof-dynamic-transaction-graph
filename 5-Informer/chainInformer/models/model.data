pe: tensor([[[ 0.0000e+00,  1.0000e+00,  0.0000e+00,  ...,  1.0000e+00,
           0.0000e+00,  1.0000e+00],
         [ 8.4147e-01,  5.4030e-01,  8.2186e-01,  ...,  1.0000e+00,
           1.0366e-04,  1.0000e+00],
         [ 9.0930e-01, -4.1615e-01,  9.3641e-01,  ...,  1.0000e+00,
           2.0733e-04,  1.0000e+00],
         ...,
         [ 9.5625e-01, -2.9254e-01,  9.3594e-01,  ...,  8.5926e-01,
           4.9515e-01,  8.6881e-01],
         [ 2.7050e-01, -9.6272e-01,  8.2251e-01,  ...,  8.5920e-01,
           4.9524e-01,  8.6876e-01],
         [-6.6395e-01, -7.4778e-01,  1.4615e-03,  ...,  8.5915e-01,
           4.9533e-01,  8.6871e-01]]], dtype=torch.float64) torch.Size([1, 5000, 512])
self.pe[:, :x.size(1)]:  tensor([[[ 0.0000e+00,  1.0000e+00,  0.0000e+00,  ...,  1.0000e+00,
           0.0000e+00,  1.0000e+00],
         [ 8.4147e-01,  5.4030e-01,  8.2186e-01,  ...,  1.0000e+00,
           1.0366e-04,  1.0000e+00],
         [ 9.0930e-01, -4.1615e-01,  9.3641e-01,  ...,  1.0000e+00,
           2.0733e-04,  1.0000e+00],
         ...,
         [-9.4828e-01,  3.1743e-01,  9.8417e-01,  ...,  9.9995e-01,
           9.6405e-03,  9.9995e-01],
         [-2.4525e-01,  9.6946e-01,  4.1505e-01,  ...,  9.9995e-01,
           9.7442e-03,  9.9995e-01],
         [ 6.8326e-01,  7.3017e-01, -5.1127e-01,  ...,  9.9995e-01,
           9.8479e-03,  9.9995e-01]]], dtype=torch.float64) torch.Size([1, 96, 512])
           


x_enc: tensor([[[ 0.1208,  1.2124,  0.2385,  ..., -0.7833,  0.0532,  0.9009],
         [ 0.5012,  1.6286,  0.3673,  ...,  0.4370,  0.6816,  1.2229],
         [ 0.4436,  1.0200,  0.4125,  ...,  0.1693,  0.3928,  1.3072],
         ...,
         [ 0.9966,  1.7248,  1.1528,  ..., -0.3368,  0.1024,  0.9698],
         [ 0.6509,  1.7889,  0.8631,  ..., -0.7540,  0.1992,  0.8932],
         [ 0.4090,  1.9812,  0.6056,  ..., -0.8732,  0.1024,  0.9239]],

        [[ 0.4897,  0.9880,  0.3351,  ...,  0.4370,  0.0532, -1.0923],
         [-0.0980, -0.0058, -0.0318,  ..., -0.3368, -0.1388, -1.0769],
         [ 0.0862,  0.4751,  0.0453,  ..., -0.0095,  0.2960, -1.1076],
         ...,
         [ 0.6624,  1.2444,  0.7343,  ..., -0.8136, -0.3815, -0.8546],
         [ 0.1669,  1.0200,  0.4125,  ..., -0.6641, -0.2356, -0.8470],
         [-0.0289,  0.7315,  0.0905,  ..., -0.7540, -0.3323, -0.8316]],

        [[ 0.6280,  0.1866,  0.8502,  ..., -1.2601, -0.2356, -0.7856],
         [ 0.4436,  0.0904,  0.7730,  ..., -1.2601, -0.0912, -0.7856],
         [ 0.6049,  0.2186,  0.9017,  ..., -1.3187, -0.0912, -0.8086],
         ...,
         [ 0.0518, -0.9349,  0.2064,  ..., -0.6045,  0.2960, -0.2797],
         [ 0.6164, -0.1019,  0.8116,  ..., -0.8136,  0.1500, -0.3334],
         [ 0.3629, -0.7426,  0.6377,  ..., -1.2005, -0.1880, -0.3334]],

        ...,

        [[-0.4438,  0.5392, -0.4053,  ..., -0.1590,  0.4896, -0.2874],
         [-0.2018,  0.6995, -0.1607,  ..., -0.1590,  0.5848, -0.4406],
         [-0.0289,  0.9559,  0.1419,  ..., -0.7237,  0.0532, -0.3564],
         ...,
         [ 0.2707, -0.9349,  0.3222,  ...,  0.0501,  0.2960, -0.0957],
         [-0.2018, -1.4157, -0.1350,  ..., -0.6641,  0.0532, -0.0573],
         [-0.1441, -1.1593, -0.0512,  ..., -0.8136, -0.0436, -0.1111]],

        [[-0.0634,  0.1866, -0.0576,  ..., -0.5752,  0.1992, -0.4483],
         [-0.1787,  0.5712, -0.0641,  ..., -0.6045,  0.3928, -0.4176],
         [-0.0634,  0.6674,  0.0390,  ..., -0.7237,  0.2960, -0.2874],
         ...,
         [-0.0634,  0.6995,  0.1033,  ..., -0.3964,  0.6816,  0.0270],
         [-0.0058,  0.7315,  0.1098,  ..., -0.1883,  0.2960,  0.0193],
         [ 0.3168,  0.1545,  0.1999,  ...,  0.1693,  0.1992, -0.0190]],

        [[ 0.8814,  2.2377,  1.0048,  ..., -0.4267,  0.6816,  0.5330],
         [-0.0634,  0.9880,  0.0261,  ..., -0.7540,  0.5372,  0.6019],
         [ 0.0862,  0.8918,  0.1419,  ..., -0.5156,  0.2468,  0.7475],
         ...,
         [ 1.5728,  1.6927,  1.3717,  ...,  1.5977,  0.8751,  0.4562],
         [ 1.5728,  1.3406,  1.2882,  ...,  2.0735,  0.9719,  0.4792],
         [ 0.6970,  1.5966,  0.4253,  ...,  1.9250,  1.1655,  0.4716]]],
       dtype=torch.float64) torch.Size([32, 96, 7])
x_mark_enc: tensor([[[-0.1087, -0.5000,  0.2000,  0.1411],
         [-0.0652, -0.5000,  0.2000,  0.1411],
         [-0.0217, -0.5000,  0.2000,  0.1411],
         ...,
         [-0.2391,  0.1667,  0.3333,  0.1521],
         [-0.1957,  0.1667,  0.3333,  0.1521],
         [-0.1522,  0.1667,  0.3333,  0.1521]],

        [[-0.0217,  0.1667,  0.3000,  0.4014],
         [ 0.0217,  0.1667,  0.3000,  0.4014],
         [ 0.0652,  0.1667,  0.3000,  0.4014],
         ...,
         [-0.1522, -0.3333,  0.4333,  0.4123],
         [-0.1087, -0.3333,  0.4333,  0.4123],
         [-0.0652, -0.3333,  0.4333,  0.4123]],

        [[-0.4565,  0.0000,  0.4667, -0.2589],
         [-0.4130,  0.0000,  0.4667, -0.2589],
         [-0.3696,  0.0000,  0.4667, -0.2589],
         ...,
         [ 0.4565,  0.5000, -0.4667, -0.2507],
         [ 0.5000,  0.5000, -0.4667, -0.2507],
         [-0.5000, -0.5000, -0.4333, -0.2479]],

        ...,

        [[ 0.1087,  0.0000, -0.2667,  0.4370],
         [ 0.1522,  0.0000, -0.2667,  0.4370],
         [ 0.1957,  0.0000, -0.2667,  0.4370],
         ...,
         [-0.0217, -0.5000, -0.1333,  0.4479],
         [ 0.0217, -0.5000, -0.1333,  0.4479],
         [ 0.0652, -0.5000, -0.1333,  0.4479]],

        [[ 0.0217, -0.1667,  0.4667,  0.4151],
         [ 0.0652, -0.1667,  0.4667,  0.4151],
         [ 0.1087, -0.1667,  0.4667,  0.4151],
         ...,
         [-0.1087,  0.5000, -0.4000,  0.4260],
         [-0.0652,  0.5000, -0.4000,  0.4260],
         [-0.0217,  0.5000, -0.4000,  0.4260]],

        [[-0.1522,  0.3333,  0.2667,  0.2315],
         [-0.1087,  0.3333,  0.2667,  0.2315],
         [-0.0652,  0.3333,  0.2667,  0.2315],
         ...,
         [-0.2826, -0.1667,  0.4000,  0.2425],
         [-0.2391, -0.1667,  0.4000,  0.2425],
         [-0.1957, -0.1667,  0.4000,  0.2425]]], dtype=torch.float64) torch.Size([32, 96, 4])
enc_out: tensor([[[-1.0689e+00,  2.8245e+00,  2.4623e+00,  ...,  5.5481e-01,
           5.7963e-01,  9.1661e-01],
         [ 1.3157e-02,  1.6431e+00,  2.3730e+00,  ..., -1.3108e-01,
           1.0293e+00,  1.4346e+00],
         [ 2.7326e-01,  3.8675e-01,  2.3731e+00,  ..., -2.3231e-01,
           7.1442e-01,  1.3518e+00],
         ...,
         [-2.9225e+00,  4.8210e-01,  4.0070e+00,  ..., -1.1785e+00,
           1.2127e+00, -2.2770e-01],
         [-2.5244e+00,  1.4030e+00,  3.0107e+00,  ..., -1.1248e+00,
           5.6481e-01, -3.1603e-01],
         [-1.2261e+00,  1.0834e+00,  1.4221e+00,  ..., -9.3395e-01,
           1.3934e+00, -2.6748e-02]],

        [[-3.9055e-01,  9.0249e-01,  8.7650e-01,  ...,  7.7188e-02,
           1.1548e+00, -1.7460e-01],
         [ 7.5624e-01,  1.2257e+00,  2.4473e+00,  ...,  6.0631e-01,
          -0.0000e+00, -1.2570e-01],
         [-7.0204e-02,  1.2203e-01,  1.5249e+00,  ..., -0.0000e+00,
          -8.2010e-01, -3.3978e-01],
         ...,
         [-2.1770e+00,  3.7116e-01,  4.3697e+00,  ..., -5.4148e-01,
           4.5259e-01, -6.1941e-01],
         [-1.2405e+00,  9.1591e-01,  2.2589e+00,  ..., -1.5330e-01,
           4.9289e-01, -3.8774e-01],
         [ 3.0099e-01,  1.7391e+00,  0.0000e+00,  ...,  1.6303e-01,
          -2.9654e-01, -0.0000e+00]],

        [[-2.7968e+00,  6.8264e-01,  6.3725e-01,  ...,  0.0000e+00,
          -0.0000e+00, -1.8115e+00],
         [-1.3985e+00,  7.7554e-01,  2.5044e+00,  ...,  0.0000e+00,
           9.2397e-02, -1.5402e+00],
         [-1.3230e+00, -1.5106e-01,  2.5049e+00,  ...,  9.2524e-01,
          -1.1321e-01, -1.5407e+00],
         ...,
         [-2.5679e+00,  7.1234e-01,  8.6083e-01,  ...,  1.9034e+00,
          -1.6442e+00, -5.9524e-01],
         [-1.9692e+00,  0.0000e+00,  3.9711e-01,  ...,  1.4734e+00,
          -0.0000e+00, -8.2601e-01],
         [-0.0000e+00,  1.0406e+00,  1.0374e+00,  ...,  1.6697e+00,
          -1.2275e+00, -1.3387e+00]],

        ...,

        [[-9.6983e-01,  2.0000e+00, -1.8310e-01,  ...,  8.2465e-01,
          -9.3800e-01,  4.1452e-01],
         [ 5.0618e-02,  1.1353e+00,  8.0152e-01,  ..., -1.9840e-01,
          -3.7756e-01,  3.2877e-01],
         [ 2.0603e-01,  2.8785e-01,  1.3939e+00,  ..., -5.1755e-04,
          -1.5807e-01,  1.8967e-01],
         ...,
         [-1.4069e+00,  4.0511e-01,  9.6695e-01,  ...,  2.8945e+00,
           6.4107e-02,  8.3686e-01],
         [-1.1343e+00,  1.2857e+00,  8.7035e-01,  ...,  3.1885e+00,
          -8.9827e-01,  7.3654e-01],
         [-0.0000e+00,  1.2495e+00, -7.8133e-01,  ...,  2.6367e+00,
          -2.2953e+00,  4.9220e-01]],

        [[-9.1660e-01,  1.5116e+00,  6.3547e-01,  ...,  6.6762e-01,
          -1.8111e-01,  3.2078e-01],
         [-4.4079e-01,  1.0623e+00,  1.1661e+00,  ...,  3.3469e-01,
          -2.8108e-01,  3.7471e-01],
         [-1.2037e-01,  2.4561e-01,  1.4616e+00,  ...,  4.5482e-01,
           6.6390e-02,  5.3966e-01],
         ...,
         [-0.0000e+00,  1.5710e+00,  2.7688e+00,  ...,  8.5435e-01,
           0.0000e+00,  1.3493e-01],
         [-9.8667e-01,  2.1792e+00,  1.2757e+00,  ...,  7.6971e-01,
           3.1294e-01,  1.2225e-01],
         [ 1.3584e-01,  1.1151e+00,  4.0376e-01,  ...,  1.1612e+00,
           7.3331e-01,  1.7236e-01]],

        [[-9.3765e-01,  9.2633e-01,  1.0820e+00,  ..., -2.4081e+00,
           0.0000e+00,  1.1916e-01],
         [-3.1239e-01,  2.1293e+00,  3.3971e+00,  ...,  5.5733e-01,
           1.2218e+00,  3.1776e-01],
         [-5.6824e-01,  7.5185e-01,  1.9787e+00,  ...,  6.0447e-01,
           3.3189e-01,  7.0251e-01],
         ...,
         [-5.1332e-01,  2.1931e+00,  3.9989e+00,  ..., -1.1689e+00,
           4.5514e-01,  4.5326e-01],
         [ 7.6448e-01,  2.8453e+00,  3.4738e+00,  ..., -6.6613e-01,
           1.7221e-01,  8.4514e-01],
         [-4.0691e-02,  1.4647e+00,  1.1023e+00,  ..., -2.9686e+00,
           5.6966e-02,  5.2731e-01]]], dtype=torch.float64,
       grad_fn=<MulBackward0>) torch.Size([32, 96, 512])
enc_out: tensor([[[-0.7455,  0.8884, -1.1558,  ..., -0.6447, -0.9194, -1.2915],
         [-0.1510,  0.9434, -1.1542,  ..., -0.9973, -1.1966, -1.4351],
         [-0.4697,  0.8243, -0.9908,  ..., -0.9667,  0.1072, -1.4130],
         ...,
         [-1.5473,  1.2369,  0.2293,  ..., -0.8930,  0.5465, -1.4409],
         [-0.8317,  1.4198,  0.2109,  ..., -0.8174,  0.3783, -1.4473],
         [-0.7224,  0.8875, -1.0823,  ..., -1.0230, -0.9227, -1.4820]],

        [[-0.9383, -1.3404,  0.7492,  ..., -0.1632, -1.6137, -1.0672],
         [-0.7031, -0.5915,  0.9245,  ...,  0.1551, -1.4276, -1.0859],
         [ 0.9291, -0.5567,  1.0473,  ...,  0.4197, -1.4888, -1.0252],
         ...,
         [-0.5859, -1.3575,  0.7240,  ...,  0.0293, -1.3160, -0.6550],
         [-0.7277, -1.1944,  0.3383,  ..., -0.0106, -1.3115, -1.2435],
         [-0.8862, -1.3166,  0.7527,  ..., -0.0842, -1.5487, -1.1025]],

        [[-0.7894, -1.6080, -0.2905,  ..., -0.7697,  0.1314, -0.9415],
         [-0.8079, -1.1494, -1.2894,  ...,  0.6463, -0.0513, -1.3853],
         [ 1.3462, -1.1190,  0.0223,  ...,  0.4283, -0.1511, -0.9496],
         ...,
         [ 1.8453, -0.0397,  0.1465,  ...,  0.5324,  0.5673,  1.3849],
         [ 1.5866, -0.7037,  0.0174,  ...,  0.0064,  0.8453,  0.4551],
         [-0.7367, -1.5918, -0.2595,  ..., -0.8287,  0.2808, -0.9141]],

        ...,

        [[-0.4363, -0.7709, -1.0044,  ...,  0.5093,  0.6710, -1.3278],
         [-0.6057, -0.3629, -0.1390,  ..., -1.5201, -0.6612, -0.8892],
         [ 1.8396, -0.9053,  0.3920,  ..., -0.3617, -1.1213, -1.0519],
         ...,
         [ 0.6762,  0.0985,  0.7117,  ...,  0.7437, -0.5537,  0.2363],
         [ 0.7574, -0.0064,  0.4295,  ...,  1.6820,  0.3493,  0.2454],
         [-0.5495, -0.4400, -1.1929,  ...,  0.4953,  0.7473, -1.2461]],

        [[ 0.1555, -1.3414,  1.3429,  ..., -0.7736, -1.6482, -1.5749],
         [-0.0434, -0.5100,  0.5229,  ...,  0.1905, -1.5212, -0.7933],
         [ 0.8531, -0.5676,  1.1741,  ...,  0.1739, -1.2000, -0.6488],
         ...,
         [-1.3755,  0.6655,  0.9717,  ..., -0.2592, -0.4977, -0.6170],
         [-0.1339,  0.5428,  2.4360,  ...,  0.9264, -0.7838, -1.1523],
         [ 0.2038, -1.4229,  1.2268,  ..., -0.6784, -1.3840, -1.3563]],

        [[-1.1713,  1.8280,  0.2039,  ..., -0.9997, -0.6570, -1.2123],
         [-0.7625,  1.9877, -0.4155,  ..., -1.2936, -0.9114, -1.6745],
         [ 1.1091,  0.2332, -0.9408,  ..., -1.1298,  0.7576, -1.4549],
         ...,
         [-0.2647,  0.2486, -0.3582,  ..., -0.7443,  0.9940, -0.7082],
         [-1.4003,  0.2224,  0.4172,  ..., -0.5165, -0.6232, -1.3055],
         [-1.1884,  1.6700,  0.2821,  ..., -0.9218, -0.7420, -1.3807]]],
       dtype=torch.float64, grad_fn=<NativeLayerNormBackward>) torch.Size([32, 26, 512])